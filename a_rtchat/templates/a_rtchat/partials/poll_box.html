{% with poll=message.poll_view %}
<div
  id="chat_poll_box_{{ message.id }}"
  data-chat-poll-box="1"
  data-message-id="{{ message.id }}"
  data-poll-id="{{ poll.id }}"
  data-poll-refresh-seconds="{{ poll.refresh_seconds|default:10 }}"
  data-poll-refresh-left="{{ poll.refresh_seconds|default:10 }}"
  class="w-full min-w-[18rem] sm:min-w-[22rem] max-w-[30rem] rounded-2xl border border-white/10 bg-gradient-to-br from-slate-800/95 via-indigo-900/40 to-sky-900/55 shadow-2xl shadow-black/30 px-4 py-4"
>
  <div class="text-2xl font-extrabold text-white leading-tight">{{ poll.question }}</div>

  <div class="mt-4 space-y-2">
    {% for opt in poll.options %}
      <button
        type="button"
        data-poll-vote-btn="1"
        data-message-id="{{ message.id }}"
        data-option-id="{{ opt.id }}"
        class="relative w-full overflow-hidden rounded-xl border border-white/15 text-left transition hover:opacity-95"
      >
        <span
          class="absolute inset-y-0 left-0 rounded-xl {% if forloop.counter0|divisibleby:2 %}bg-gradient-to-r from-emerald-400 to-lime-400{% else %}bg-gradient-to-r from-sky-400 to-indigo-500{% endif %}"
          style="width: {% if poll.total_votes > 0 %}{{ opt.percent }}{% else %}0{% endif %}%;"
        ></span>
        <span class="relative z-10 flex items-center justify-between gap-3 px-4 py-2.5">
          <span class="font-bold text-xl text-white/95 truncate">{{ opt.text }}</span>
          <span class="shrink-0 text-xl font-extrabold text-white">{% if poll.total_votes > 0 %}{{ opt.percent }}%{% else %}0%{% endif %}</span>
        </span>
      </button>
    {% endfor %}
  </div>

  <div class="mt-3 flex items-center justify-between text-xs text-gray-200/90">
    <span>{{ poll.total_votes }} vote{{ poll.total_votes|pluralize }}</span>
  </div>
</div>
{% endwith %}
